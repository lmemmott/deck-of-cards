var deck=function(b){'use strict';var c=35,d=46,e=0,f=1,g=2,h=function(a){var b=null,h=null,i=null,j=e,k=0;for(var l=0;l<=a.length;l++){var m=a.charCodeAt(l),n=m===c,o=m===d,p=!m;(n||o||p)&&(j===e?(l===0?(b='div'):(b=a.substring(k,l))):j===f?(h=a.substring(k,l)):i?(i+=' '+a.substring(k,l)):(i=a.substring(k,l)),n?(j=f):o&&(j=g),k=l+1)}return{tag:b,id:h,className:i}},j=function(a,b){var c=h(a),d=c.tag,e=c.id,f=c.className,g=b?document.createElementNS(b,d):document.createElement(d);e&&(g.id=e);f&&(b?g.setAttribute('class',f):(g.className=f));return g},k=function(a,b){var c=B(a),d=B(b);b===d&&d.__redom_view&&(b=d.__redom_view);d.parentNode&&(l(b,d,c),c.removeChild(d));return b},l=function(a,b,c){var d=b.__redom_lifecycle;if(m(d)){b.__redom_mounted=!1;return}var e=c;b.__redom_mounted&&r(b,'onunmount');while(e){var f=e.__redom_lifecycle||{};for(var g in d)f[g]&&(f[g]-=d[g]);m(f)&&(e.__redom_lifecycle=null);e=e.parentNode}},m=function(a){if(a==null){return !0}for(var b in a){if(a[b]){return !1}}return !0},n=['onmount','onremount','onunmount'],o=typeof window!=='undefined'&&'ShadowRoot' in window,p=function(a,b,c,d){var e=B(a),f=B(b);b===f&&f.__redom_view&&(b=f.__redom_view);b!==f&&(f.__redom_view=b);var g=f.__redom_mounted,h=f.parentNode;g&&h!==e&&l(b,f,h);c!=null?(d?e.replaceChild(f,B(c)):e.insertBefore(f,B(c))):e.appendChild(f);q(b,f,e,h);return b},q=function(a,b,c,d){var e=b.__redom_lifecycle||(b.__redom_lifecycle={}),f=c===d,g=!1;for(var h=0,i=n;h<i.length;h+=1){var j=i[h];f||(a!==b&&(j in a&&(e[j]=(e[j]||0)+1)));e[j]&&(g=!0)}if(!g){b.__redom_mounted=!0;return}var k=c,l=!1;(f||k&&k.__redom_mounted)&&(r(b,f?'onremount':'onmount'),l=!0);while(k){var m=k.parentNode,p=k.__redom_lifecycle||(k.__redom_lifecycle={});for(var q in e)p[q]=(p[q]||0)+e[q];if(l){break}else (k===document||o&&k instanceof window.ShadowRoot||m&&m.__redom_mounted)&&(r(k,f?'onremount':'onmount'),l=!0),k=m}},r=function(a,b){b==='onmount'||b==='onremount'?(a.__redom_mounted=!0):b==='onunmount'&&(a.__redom_mounted=!1);var c=a.__redom_lifecycle;if(!c){return}var d=a.__redom_view,e=0;d&&d[b]&&d[b]();for(var f in c)f&&e++;if(e){var g=a.firstChild;while(g){var h=g.nextSibling;r(g,b);g=h}}},s=function(a,b,c){var d=B(a);if(c!==undefined)d.style[b]=c;else if(C(b))d.setAttribute('style',b);else{for(var e in b)s(d,e,b[e])}},t='http://www.w3.org/1999/xlink',u=function(a,b,c){var d=B(a),e=d instanceof SVGElement;if(c!==undefined){if(b==='style')s(d,c);else if(e&&D(c))d[b]=c;else if(b==='dataset')w(d,c);else if(!e&&(b in d||D(c)))d[b]=c;else{if(e&&b==='xlink'){v(d,c);return}d.setAttribute(b,c)}}else{for(var f in b)u(d,f,b[f])}};function v(a,b){for(var c in b)a.setAttributeNS(t,c,b[c])}function w(a,b){for(var c in b)a.dataset[c]=b[c]}var x=function(a){return document.createTextNode(a!=null?a:'')},y=function(a,b){for(var c=0,d=b;c<d.length;c+=1){var e=d[c];if(e!==0&&!e){continue}var f=typeof e;f==='function'?e(a):f==='string'||f==='number'?a.appendChild(x(e)):E(B(e))?p(a,e):e.length?y(a,e):f==='object'&&u(a,e)}},A=function(a){return C(a)?H(a):B(a)},B=function(a){return a.nodeType&&a||!a.el&&a||B(a.el)},C=function(a){return typeof a==='string'},D=function(a){return typeof a==='function'},E=function(a){return a&&a.nodeType},F={},G=function(a){return F[a]||(F[a]=j(a))},H=function(a){var b=arguments,c=[],d=arguments.length-1;while(d-->0)c[d]=b[d+1];var e;if(C(a))e=G(a).cloneNode(!1);else if(E(a))e=a.cloneNode(!1);else if(D(a)){var f=a;e=new (Function.prototype.bind.apply(f,[null].concat(c)))}else{throw new Error('At least one argument required')};y(B(e),c);return e};H.extend=function(a){var b=arguments,c=[],d=arguments.length-1;while(d-->0)c[d]=b[d+1];var e=G(a);return H.bind.apply(H,[this,e].concat(c))};var I=H,J=function(a){var b=arguments,c=[],d=arguments.length-1;while(d-->0)c[d]=b[d+1];var e=B(a),f=K(a,c,e.firstChild);while(f){var g=f.nextSibling;k(a,f);f=g}};function K(a,b,c){var d=c,e=new Array(b.length);for(var f=0;f<b.length;f++)e[f]=b[f]&&B(b[f]);for(var g=0;g<b.length;g++){var h=b[g];if(!h){continue}var i=e[g];if(i===d){d=d.nextSibling;continue}if(E(i)){var j=d&&d.nextSibling,k=h.__redom_index!=null,l=k&&j===e[g+1];p(a,h,d,l);l&&(d=j);continue}h.length!=null&&(d=K(a,h,d))}return d}var L=function(a){return function(b){return b[a]}},M=function d(a,b,c){this.View=a;this.initData=c;this.oldLookup={};this.lookup={};this.oldViews=[];this.views=[];b!=null&&(this.lookup={},this.key=D(b)?b:L(b))};M.prototype.update=function c(a,b){var d=this,e=d.View,f=d.key,g=d.initData,h=f!=null,i=this.lookup,j={},k=new Array(a.length),l=this.views;for(var m=0;m<a.length;m++){var n=a[m],o=void 0;if(h){var p=f(n);o=i[p]||new e(g,n,m,a);j[p]=o;o.__redom_id=p}else o=l[m]||new e(g,n,m,a);o.update&&o.update(n,m,a,b);var q=B(o.el);q.__redom_view=o;k[m]=o}this.oldViews=l;this.views=k;this.oldLookup=i;this.lookup=j};var N=function(a,b,c,d){return new O(a,b,c,d)},O=function e(a,b,c,d){this.__redom_list=!0;this.View=b;this.initData=d;this.views=[];this.pool=new M(b,c,d);this.el=A(a);this.keySet=c!=null};O.prototype.update=function c(a,b){var d=this;a===void 0&&(a=[]);var e=this,f=e.keySet,g=this.views;this.pool.update(a,b);var h=this.pool,i=h.views,j=h.lookup;if(f){for(var l=0;l<g.length;l++){var m=g[l],n=m.__redom_id;j[n]==null&&(m.__redom_index=null,k(d,m))}}for(var o=0;o<i.length;o++){var p=i[o];p.__redom_index=o}J(this,i);f&&(this.lookup=j);this.views=i};O.extend=function(a,b,c,d){return O.bind(O,a,b,c,d)};N.extend=O.extend;var P='spade heart club diamond'.split(' '),Q='A 2 3 4 5 6 7 8 9 10 J Q K'.split(' '),R=[[[0,0]],[[0,-1],[0,1,!0]],[[0,-1],[0,0],[0,1,!0]],[[-1,-1],[1,-1],[-1,1,!0],[1,1,!0]],[[-1,-1],[1,-1],[0,0],[-1,1,!0],[1,1,!0]],[[-1,-1],[1,-1],[-1,0],[1,0],[-1,1,!0],[1,1,!0]],[[-1,-1],[1,-1],[0,-0.5],[-1,0],[1,0],[-1,1,!0],[1,1,!0]],[[-1,-1],[1,-1],[0,-0.5],[-1,0],[1,0],[0,-0.5],[-1,1,!0],[1,1,!0]],[[-1,-1],[1,-1],[-1,-0.3333333333333333],[1,-0.3333333333333333],[0,0],[-1,0.3333333333333333,!0],[1,0.3333333333333333,!0],[-1,1,!0],[1,1,!0]],[[-1,-1],[1,-1],[0,-0.6666666666666666],[-1,-0.3333333333333333],[1,-0.3333333333333333],[-1,0.3333333333333333,!0],[1,0.3333333333333333,!0],[0,0.6666666666666666,!0],[-1,1,!0],[1,1,!0]],[[0,0]],[[0,0]],[[0,0]]],S=function a(){this.el=I(".card-front",this.suits=N('.card-suits',T),I('.card-tl',this.rank1=I('.card-rank'),this.suit1=I('.card-suit')),I('.card-br',this.rank2=I('.card-rank'),this.suit2=I('.card-suit')))};S.prototype.update=function b(a){if(a==null){this.el.className='card-front';this.suits.update([]);this.rank1.textContent='';this.rank2.textContent='';this.suit1.textContent='';this.suit2.textContent='';return}var c=Math.floor(a/13)%4,d=a%13,e=Math.floor(a/13)%2?'red':'black',f=d===0,g=d>9;e==='red'?(this.el.classList.add('red'),this.el.classList.remove('black')):(this.el.classList.add('black'),this.el.classList.remove('red'));this.value=d+1;this.suits.update(R[d],{suit:c,value:d,color:e,ace:f,royal:g});this.rank1.textContent=Q[d];this.rank2.textContent=Q[d];this.suit1.style.backgroundImage="url(img/"+P[c]+".svg)";this.suit2.style.backgroundImage="url(img/"+P[c]+".svg)"};var T=function a(){this.el=I('.card-suit')};T.prototype.update=function e(a,b,c,d){var f=d.value,g=d.suit,h=d.ace,i=d.royal;i?(this.el.textContent=Q[f],this.el.style.backgroundImage=''):(this.el.textContent='',this.el.style.backgroundImage="url(img/"+P[g]+".svg)");this.el.className=h?'card-suit ace':i?'card-suit royal':'card-suit';this.el.style.left=a[0]*100+"%";this.el.style.top=a[1]*100+"%";this.el.style.transform="translate(-50%, -50%) rotate("+!!a[2]*180+"deg)";this.el.style.fontWeight=i?'300':''};var U=function c(a,b){b===void 0&&(b='front');this.el=I('.card',this.container=I('.card-container',this.front=new S(),this.back=I('.card-back',this.backTexture=I('.card-back-texture'))));this.setIndex(a%52);this.side=b},V={side:{configurable:!0}};U.prototype.setIndex=function b(a){this.index=a;this.front.update(a)};U.prototype.set=function b(a){var c=a.x;c===void 0&&(c=this.x);var d=a.y;d===void 0&&(d=this.y);var e=a.z;e===void 0&&(e=this.z);this.x=c;this.y=d;this.z=e;this._set({x:c,y:d,z:e})};U.prototype._set=function b(a){var c=a.x;c===void 0&&(c=this.x);var d=a.y;d===void 0&&(d=this.y);var e=a.z;e===void 0&&(e=this.z);this.el.style.transform="translate("+(c*5-e/52)+"em, "+(d*7-e/52)+"em)"};V.side.get=function(){return this._side};V.side.set=function(a){if(a===this._side){return}a==='front'?(this.back.style.display='none',p(this.container,this.front)):(k(this.container,this.front),this.back.style.display='');this._side=a};U.prototype.dealTo=function c(a,b){var d=b.side,e=b.delay,f=b.index;f===void 0&&(f=this.parent.cards.indexOf(this));return this.parent.dealTo(a,{side:d,delay:e,index:f})};Object.defineProperties(U.prototype,V);U.create=function(a,b){return new U(a,b)};var W=function b(a){a===void 0&&(a={});var c=a.x;c===void 0&&(c=0);var d=a.y;d===void 0&&(d=0);var e=a.z;e===void 0&&(e=0);this.el=I('.deck',I('.deck-bg'),this.$cards=I('.cards'));this.cards=[];this.generate(52);this.set({x:c,y:d,z:e})};W.prototype.set=function b(a){var c=a.x;c===void 0&&(c=this.x);var d=a.y;d===void 0&&(d=this.y);var e=a.z;e===void 0&&(e=this.z);this.x=c;this.y=d;this.z=e;this.el.style.transform="translate("+(c*5-e/52)+"em, "+(d*7-e/52)+"em)"};W.prototype.generate=function b(a){for(var c=0;c<a;c++){var d=new U(a-1-c);this.push(d)}};W.prototype.getPosition=function b(a){var c=0,d=0,e=a;return{x:c,y:d,z:e}};W.prototype.remove=function b(a){for(var c=0;c<this.cards.length;c++)this.cards[c]===a&&this.cards.splice(c--,1)};W.prototype.push=function b(a){a.parent&&a.parent.remove(a);this.cards.push(a);a.parent=this;this.$cards.appendChild(a.el);for(var c=0;c<this.cards.length;c++){var d=this.getPosition(c),e=d.x,f=d.y,g=d.z;this.cards[c].set({x:e,y:f,z:g})}};function X(a){for(var b=a.length-1;b;b--){var c=Math.random()*b|0,d=a[b];a[b]=a[c];a[c]=d}return a}function Y(a,b){a._queue||(a._queue=[]);a._queue.push(b);Z(a)}var Z=function(a){if(a._queueServing){return}if(!a._queue.length){return}a._queueServing=!0;var b=a._queue.shift(),c=function(){a._queueServing=!1;Z(a)};b(c)},_=function b(a){a===void 0&&(a={});var c=a.x;c===void 0&&(c=0);var d=a.y;d===void 0&&(d=0);var e=a.z;e===void 0&&(e=0);var f=a.rotate;f===void 0&&(f=!1);var g=a.spread;g===void 0&&(g=0.16666666666666666);this.el=I('.hand',I('.hand-bg'),this.$cards=I('.cards'));this.cards=[];this.rotate=f;this.spread=g;this.set({x:c,y:d,z:e})};_.prototype.queue=function b(a){Y(this,a)};_.prototype.set=function b(a){var c=a.x;c===void 0&&(c=this.x);var d=a.y;d===void 0&&(d=this.y);var e=a.z;e===void 0&&(e=this.z);var f=a.r;f===void 0&&(f=this.r);this.x=c;this.y=d;this.z=e;this.el.style.transform="translate("+(c*5-e/52)+"em, "+(d*7-e/52)+"em)"};_.prototype.getPosition=function b(a){var c=(this.rotate?-1:1)*a*this.spread,d=0,e=a;return{x:c,y:d,z:e}};_.prototype.remove=function b(a){for(var c=0;c<this.cards.length;c++)this.cards[c]===a&&this.cards.splice(c--,1)};_.prototype.push=function b(a){a.parent&&a.parent.remove(a);this.cards.push(a);this.$cards.appendChild(a.el);a.parent=this;for(var c=0;c<this.cards.length;c++){var d=this.getPosition(c),e=d.x,f=d.y,g=d.z;this.cards[c].set({x:e,y:f,z:g})}};_.prototype.flip=function e(a,b,c,d){var f=c.side,g=c.delay;g===void 0&&(g=0);return this.cards[a].flipTo(b,{side:f,delay:g},d)};var $=function a(){this.el=I('.scene')};$.prototype.push=function b(a){p(this.el,a.el)};b.Card=U;b.Deck=W;b.fisherYates=X;b.Hand=_;b.Scene=$;return b}({})
